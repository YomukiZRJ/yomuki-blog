<!--
 * @Desc: 
 * @Author: æ›¾èŒ¹è
 * @Date: 2022-08-22 09:51:08
 * @LastEditors: æ›¾èŒ¹è
 * @LastEditTime: 2022-08-22 11:38:44
-->
# å·¥ä½œéœ€æ±‚è®°å½•ï¼šå…³äºè¦åˆ†åˆ«æ‰“åŒ…mgopå’Œaxiosæƒ…å†µä¸‹çš„æ„å»º
å› ä¸ºä¼šåŒæ—¶ä¸Šæ¶æµ™é‡ŒåŠå’Œå…¶ä»–å¹³å°ï¼Œæ‰€ä»¥æ‰“åŒ…çš„æ—¶å€™éœ€å¯¹åº”ä¸åŒå¹³å°æ‰“åŒ…ä¸åŒçš„æ¥å£ã€‚æµ™é‡ŒåŠç”¨mgopï¼Œå…¶ä»–ç”¨axios
## æ”¹å†™æ¥å£ç±»
åŸå…ˆç”¨çš„æ˜¯å°è£…äº†axiosçš„AxiosApiç±»ï¼Œç±»ä¸­æœ‰å‡½æ•°get,post
æµ™é‡ŒåŠçš„æ¥å£æ–°å°äº†ä¸€ä¸ªMgopApiç±»ï¼Œç±»ä¸­æœ‰å‡½æ•°get,post
å®ƒä»¬çš„æ¥å£URLæ˜¯ä¸åŒçš„ã€‚axiosæ˜¯æ­£å¸¸çš„urlï¼Œè€Œmgopæ˜¯é…ç½®å¥½çš„å­—ç¬¦ä¸²
AxiosApiå’ŒMgopApiä¸­çš„å‡½æ•°å…¥å‚ç›¸åŒï¼Œè¿”å›å‡ä¸ºPromise
### æ–¹æ¡ˆ1 ï¼š é€‚é…å™¨æ¨¡å¼
1. åˆ›å»º BaseApiç±» ä½œä¸º é€‚é…å™¨
2. é€šè¿‡nodeç¯å¢ƒå˜é‡æ³¨å…¥æ¥åˆ¤æ–­æ˜¯é€‚é…AxiosApiè¿˜æ˜¯MgopApi
3. åœ¨ BaseApi ä¸­å®šä¹‰post , getå‡½æ•°ï¼ŒåŸå…ˆçš„urlå…¥å‚ä¸ºå­—ç¬¦ä¸²ï¼Œç°æ”¹ä¸ºå¯¹è±¡`{axiosUrl,mgopUrl}`
4. é€šè¿‡ç¯å¢ƒå˜é‡å®šä¹‰ä½¿ç”¨çš„å“ªä¸ªurlå±æ€§
5. è°ƒç”¨ç”Ÿæˆç±»çš„ç›¸åº”å‡½æ•°
ä»£ç å®ç°ï¼š
```js
import AxiosApi from "./AxiosApi";
import MgopApi from "./MgopApi";
class BaseApi {
  baseService;
  urlPropertyName;
  constructor() {
    this.baseService =
      process.env.APP_API_TYPE === "mgop"
        ? new MgopApi({ baseURL: "https://xxxxx" })
        : new AxiosApi({ baseURL: `${process.env.APP_BASE_URL}` });
    this.urlPropertyName = process.env.APP_IS_MGOP === "mgop" ? "mgopUrl" : "axiosUrl";
  }
  get(url, ...args) {
    if (url[this.urlPropertyName]) {
      return this.baseService.get(url[this.urlPropertyName], ...args);
    }
  }
  post(url, ...args) {
    if (url[this.urlPropertyName]) {
      return this.baseService.post(url[this.urlPropertyName], ...args);
    }
  }
}
export default new BaseApi();

```
## ç¯å¢ƒå˜é‡
è‡³æ­¤éœ€æ±‚æ˜¯å®ç°äº†ï¼Œä½†æ˜¯æ¯æ¬¡æ”¹ç¯å¢ƒå˜é‡å¤ªéº»çƒ¦äº†ï¼Œæ‰€ä»¥å¸Œæœ›åœ¨ scripts ä¸­å®šä¹‰å¥½äº†ï¼Œé€šè¿‡å‘½ä»¤æ¥ç¡®å®šæ˜¯æ‰“åŒ…axiosè¿˜æ˜¯mgopã€‚
è¿™æ˜¯ç›®å‰çš„scripts
```js
"scripts": {
    "dev": "cross-env NODE_ENV=development webpack serve --progress --config ./build/webpack.dev.js",
    "build": "cross-env NODE_ENV=production webpack --config ./build/webpack.prod.js",
},
```
### æ–¹æ¡ˆ1 ï¼š ç›´æ¥å†å†™ä¸¤ä¸ªwebpacké…ç½®æ–‡ä»¶
ğŸ™ŠğŸ™Šç®€å•ç²—æš´ä½†å¥½ä¸ä¼˜é›…
### æ–¹æ¡ˆ2 ï¼š[cross-env](https://www.npmjs.com/package/cross-env) æ³¨å…¥
- dev build : æ„å»ºaxiosçš„
- dev:mgop build:mgop : æ„å»ºmgopçš„
```js
  "scripts": {
    "dev": "cross-env NODE_ENV=development webpack serve --progress --config ./build/webpack.dev.js",
    "build": "cross-env NODE_ENV=production webpack --config ./build/webpack.prod.js",
    "dev:mgop": "cross-env NODE_ENV=development API=\"mgop\" webpack serve --progress --config ./build/webpack.dev.js",
    "build:mgop": "cross-env NODE_ENV=production API=\"mgop\"  webpack --config ./build/webpack.prod.js",
  },
```
## ç¢ç¢å¿µ
- ä¸ºä»€ä¹ˆä¸ç”¨å¸ƒå°”å€¼å‘¢ï¼Œå› ä¸ºæ€•ä»¥åä¼šå‡ºç°ç¬¬ä¸‰ç§æ¥å£æƒ…å†µã€‚
- ä½†æ˜¯åº”è¯¥ä¸ä¼šå‡ºç°mgopå’ŒaxiosåŒæ—¶ç”¨çš„æƒ…å†µå§ï¼Ÿä¸ä¼šå§ä¸ä¼šå§ä¸ä¼šå§ã€‚
- é™¤æµ™é‡ŒåŠå¤–çš„ç¯å¢ƒè‚¯å®šæ˜¯ç”¨ä¸åˆ°mgopçš„
- ä½†æ˜¯æµ™é‡ŒåŠå†…å¯èƒ½å°±ä¸å¥½è¯´äº†~å¦‚æœå‡ºç°è¿™ç§æƒ…å†µï¼Œåº”è¯¥ä¼šå†å†™ä¸ªAllApiç±»ğŸ™ˆğŸ™ˆå¥½ä¸ä¼˜é›…