# WebGIS

## 相关资料

- [火星 gis-pdf](http://marsgis.cn/doc/study-gis.pdf)

## 坐标系：墨卡托投影

墨卡托(Mercator)投影，是一种“等角正切圆柱投影”，原理是**假设地球被围在一中空的圆柱里，其标准纬线与圆柱相切接触，再假想地球中心有一盏灯，把球面上的图形投影到圆柱体上，把圆柱体展开**，这就是一幅选定标准纬线上的“墨卡托投影”绘制出的地图。  
墨卡托投影经纬线横平竖直。经线之间间距相等。形状和角度不变。赤道处面积不变，纬度越高，面积放大的倍数越大。  
![img](https://assets.yomuki.com/md/Xnip2022-09-22_16-10-56.jpg)

### Web 墨卡托投影：EPSG3857

Web Mercator（墨卡托）是由 Google 最先发明的。在投影过程中，将表示地球的参考椭球体近似的作为正球体处理（正球体半径 R = 椭球体半长轴 a）。由于墨卡托投影当纬度接近两极时，y 值趋向于无穷大，那些“懒惰的工程师”为了方便，就把 Y 轴的取值范围也限定在 X 轴相同范围，搞个正方形地图，而形成了 Web Mercator 投影。  
目前在互联网上的大部分全国公众地图网站均采用此坐标系。  
投影坐标系范围是：

- 最小 ( -20037508.3427892, -20037508.3427892)
- 最大 ( 20037508.3427892, 20037508.3427892)
  对应的纬度范围是：
- 最小 (-180, -85.05112877980659 )，最大 ( 180, 85.05112877980659 )

### 当前通用的坐标系标准

国际：

- WGS84 坐标系 【EPSG4326】  
  国内：
- 1985 国家高程基准
- 两个已弃用参心坐标系：北京 54、西安 80
- 2000 国家大地坐标系（CGCS2000）【EPSG4490】
- 火星坐标系(GCJ-02)

### WKID 与 EPSG

WKID 即 Well Known ID，众所周知的 ID 号的意思。EPSG 是管理这些 ID 号的一个组织，网站是 epsg.io  
通常来说，一个 GIS 里的坐标系统，必须有一个 WKID，某些特别的除外  
常见 EPSG:

- EPSG4326 WGS84 美国 GPS 使用的一个全球地理坐标系统
- EPSG4490 CGCS2000 中国国家 2000 地理坐标系统
- EPSG3857 Web Mercator 投影

## GIS 数据

GIS 地图数据由不同图层构成，各图层内的数据可以分为矢量或栅格数据。  
矢量数据：矢量数据结构是如同 X,Y（或者 X,Y,Z）坐标，利用点，线，面的形式来表达现实世界，具有定位明显，属性隐含的特点。由于矢量数据具有数据结构紧凑，冗余度低，表达精度高。 （shp，kml，geojson，dxf/dwg）  
栅格数据：瓦片图 。用于空间分析和地表模拟。（tif，dem，img）  
二维 WebGIS 的地图结构：

- 栅格底图图层
- 矢量图片

三维 WebGIS 的地图结构：

- 地形图层
- 栅格底图图层
- 三维模型层
- 矢量图层

### 瓦片图

一个超过屏幕大小的大地图，将它的每一块地形对应一张很小的图片，我们称这些小图片为瓦片。把这些瓦片拼接起来，就是完整的地图。  
![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e3116203bff944e1bd569a3e2af5cd94~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp)  
**瓦片地图金字塔模型**是一种多分辨率层次模型，从瓦片金字塔的底层到顶层，分辨率越来越低，但表示的地理范围不变。  
把缩放级别最高，地图尺寸最大的地图图片作为金字塔的底层（第 0 层），对其进行分块，分块从**左上角开始，从左至右，从上至下**，分割为相同大小的正方形地图瓦片，形成第 0 层瓦片矩阵。  
在第 0 层的基础上，按每像素分割为 2x2 的方法生成第 1 层地图图片，并对其分块。

- 由第 n 层的图片层 生成 第 n 层瓦片矩阵
- 第 n 层的图片层 由 第 n-1 层的图片层每个像素\*2 而来。（放大一倍）
- 总共有 N-1 层（N：地图服务平台所提供的缩放级别的数量）

瓦片地图一般采用 zyx 规范的地图瓦片。（瓦片层级，瓦片 x 坐标，瓦片 y 坐标）

- [瓦片图数据存储说明](http://support.supermap.com.cn/DataWarehouse/WebDocHelp/iServer/Subject_introduce/Cache/MapCache/TileFormat/ZXY_format.htm)

### 瓦片数据源如何获取？

使用生成工具

- [Tiled](https://www.mapeditor.org/)
- [arcgis](https://developers.arcgis.com/)
- [天地图](http://lbs.tianditu.gov.cn/server/MapService.html)
